# Apache Configuration for Subdirectory Deployment
# When OMS Launch is in a subdirectory like /var/www/html/oms_launch

# Option A: Using .htaccess (place this content in /var/www/html/oms_launch/.htaccess)
# This is the easiest option if AllowOverride is enabled

# Option B: Add to your main Apache configuration or VirtualHost
# Replace /oms_launch with your actual subdirectory path

# Add this inside your <VirtualHost> block or main apache config:

Alias /oms_launch /var/www/html/oms_launch

<Directory /var/www/html/oms_launch>
    Options -Indexes +FollowSymLinks
    AllowOverride All
    Require all granted

    # Enable rewrite engine
    RewriteEngine On
    RewriteBase /oms_launch/

    # Don't rewrite files or directories that exist
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d

    # API endpoints (ensure they're accessible)
    RewriteRule ^api/(.*)$ api/$1 [L]

    # Direct access to PHP files
    RewriteCond %{REQUEST_FILENAME} -f
    RewriteRule \.php$ - [L]
</Directory>

# Security: Prevent access to sensitive files
<DirectoryMatch "^/var/www/html/oms_launch/(\.git|\.env|config|logs)">
    Require all denied
</DirectoryMatch>

<FilesMatch "^(\.env|\.env\..*|schema\.sql)$">
    Require all denied
</FilesMatch>

# IMPORTANT: Update your .env file with the correct BASE_URL
# For subdirectory deployment, BASE_URL should be:
# BASE_URL=http://example.com/oms_launch
# or
# BASE_URL=https://example.com/oms_launch
